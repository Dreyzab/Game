# Концепция Игрового Процесса: Первый Выход на Карту

> **Примечание:** Это концептуальный документ о геймдизайне карты.  
> Для технической документации см. `MAP_GUIDE.md`, `TECHNICAL_ANALYSIS_MAP.md`  
> Для известных проблем см. `MAP_CONFLICTS_AND_BUGS.md`

---

1. Состояние карты при первом запуске

После завершения пролога игрок впервые получает доступ к основной карте города Фрайбурга (на своём КПК). Игра автоматически переключается на экран карты (/map), предварительно выставив нужные флаги (например, arrived_at_freiburg – прибыл во Фрайбург) и активировав целевую точку

. На карте отображается лишь ограниченный участок вокруг сортировочной станции – остальная часть города скрыта “туманом войны” (неизвестные области не показаны, пока не исследованы). В этот момент на карте доступны следующие элементы:

Активные квестовые маркеры: Отмечают цели текущих заданий:

“Шанс для новичка” – яркая пульсирующая иконка над точкой лавка «Ржавый Якорь». Этот квест был выдан Гансом и требует забрать у торговца Элиаса ящик с запчастями для мастера Дитера

. Маркер виден сразу, так как условия активации выполнены (игрок встретил Ганса и получил КПК)

. Иконка привлекает внимание как основная ближайшая цель (своего рода «путеводная звезда» для новичка).

Доставка посылки профессора – более тусклая (приглушённая) иконка над точкой «Кампус Синтеза». Это глобальная цель сюжета – доставить пакет документов некоему профессору

. Игрок лишь приблизительно знает местонахождение профессора (кампус научной фракции "Синтез"), поэтому маркер отображается неярко, указывая предполагаемое направление. Этот квест не срочный, и информации о точном месте у игрока пока нет (требуется сначала разузнать детали у местных).

Информационные маркеры: Точки интереса, упомянутые старушкой-регистратором, отмечены особым значком. Они дают зацепки для исследования, но не являются активными заданиями:

Промзона Артисанов: отмечена иконкой промышленной зоны. Старуха подсказала, что там можно найти работу у Артисанов. Пока это лишь ориентир на карте, без конкретного задания.

Кафедральный собор: иконка религиозной достопримечательности. Старушка упомянула настоятеля, который может нуждаться в помощи.

Штаб FJR: иконка базы Фрайбургского Жилищного Резерва (военной фракции). Возможно, там можно взять задания для рекрутов.

Августинерплац (район анархистов): помечен особой иконкой с предупреждающим красным оттенком. Старуха намекнула, что это опасный район, контролируемый анархистами. Маркер служит скорее предостережением – новичку туда соваться не стоит без необходимости.

Известные NPC и сервисы: На карте обозначены NPC, с которыми игрок уже знаком, и полезные точки обслуживания:

Инфо-бюро (старушка-регистратор): прямо на станции отмечена иконка информационного бюро, где работает приветливая старуха. Игрок уже общался с ней в прологе, но и сейчас может нажать на её значок, чтобы при необходимости повторно получить советы. (В дизайне предусмотрено, что этот NPC остаётся доступным, возможно, с коротким повторным диалогом или подсказками, чтобы освежить память игрока). Примечание: точка инфо-бюро изначально стала видимой именно после пролога благодаря флагу arrived_at_freiburg

.

Ганс: временно поблизости может отображаться иконка Ганса (например, у выхода со станции). Это отражает то, что сразу после встречи он ещё находится неподалёку. Игрок при желании может попытаться снова с ним заговорить. Однако Ганс надолго не задерживается – он вскоре уйдёт по своим делам. Повторный диалог с ним, если и возможен, будет кратким (в духе «Не теряй время, иди в город и докажи, что чего-то стоишь»), поскольку основную информацию он уже сообщил.

Безопасная зона станции: Вся территория сортировочной станции обведена зелёным контуром, обозначая “Безопасную зону” под контролем FJR. Это наглядно показывает новичку, что на станции ему ничего не угрожает – здесь действуют законы порядка. (На карте безопасные зоны могут включаться/отключаться специальным слоем

,  по умолчанию для первой сцены станция подсвечена, чтобы игрок понял статус территории).

Опасные зоны: Не отображаются. Игрок ещё не покидал безопасных районов и не сталкивался с монстрами или аномалиями, поэтому сведения об опасных зонах у него отсутствуют. (В будущем, при получении информации о крайне опасных областях, на карте могут появляться красные области — но пока карта чиста, кроме отмеченных точек интереса).

В целом, первый взгляд на карту даёт игроку базовую ориентацию: где он находится (станция), куда можно пойти за первым заданием, какие фракционные зоны есть поблизости, и где находится его глобальная цель. Большая часть города остаётся неизвестной, стимулируя любопытство для дальнейшего исследования.

2. Механика взаимодействия с точками на карте

При нажатии на любой доступный значок на карте открывается всплывающее окно MapPointPopup с информацией о данной точке и возможными действиями. Это соответствует общему UX: выбор точки открывает меню взаимодействия, если для точки предусмотрены опции, или сразу запускает событие (сцену), если выбор не требуется

. В Pop-up обычно отображается название места, краткое описание и одна или несколько кнопок действий. Рассмотрим разные случаи:

Квестовая точка (пример: лавка «Ржавый Якорь») – Pop-up отображает информацию вроде: «Лавка торговца Элиаса. Здесь вы должны забрать запчасти для мастера Дитера.» Доступны две кнопки:

[Навигация] – проложить маршрут до этой точки. При нажатии игра может выделить на карте путь или направление к цели (если предусмотрена навигация по карте или AR-маршрут). В любом случае, эта кнопка помогает сориентироваться, куда идти в реальном мире или виртуальном пространстве.

[Взаимодействовать] – активная кнопка, позволяющая начать событие, связанное с точкой. В данном случае, нажатие в момент, когда игрок прибудет на место (то есть окажется рядом с лавкой) запускает сцену визуальной новеллы trader_meeting_dialog – первую встречу с торговцем Элиасом. (Если игрок ещё физически не дошёл до локации, имеет смысл либо не давать нажать эту кнопку, либо при нажатии вывести подсказку типа «Вы слишком далеко. Сначала доберитесь до места». В нашем дизайне предполагается, что интеракция происходит по прибытии). В ходе этой сцены произойдёт диалог с Элиасом, в котором игрок предъявит просьбу от Ганса и получит ящик с запчастями. После завершения диалога игра вызовет обновление прогресса квеста (например, отметит шаг “поговорить с Элиасом” выполненным и активирует следующий шаг – доставить ящик Дитеру)

.

Информационная точка (пример: Промзона Артисанов) – Pop-up может содержать описание: «Промышленный район, контролируемый фракцией Артисанов. Здесь можно поискать работу или встретить ремесленников.» Кнопки:

[Навигация] – доступна, чтобы проложить маршрут в эту область. Игрок может отправиться туда свободно.

[Взаимодействовать] – неактивна (серая). Поскольку у игрока нет конкретного задания или контакта в этом месте, непосредственно “исполнить” сейчас нечего. Попытка нажать даст понять, что сначала нужно самостоятельно разведать территорию.
Логика: персонаж осознаёт, что “у меня нет конкретной цели в этой локации. Нужно сперва туда добраться и поискать кого-то, кто захочет поговорить.” Иными словами, игра побуждает игрока самостоятельно найти контент в этой зоне. (В дальнейшем, после посещения, возможно появятся новые активные точки внутри промзоны – например, NPC или доска объявлений Артисанов.)

“Закрытая” точка с требованием QR-сканирования (пример: Старый терминал) – Некоторые точки могут быть изначально недоступны, пока игрок не выполнит определённое действие в реальном мире. Предположим, рядом со станцией имеется объект “Старый терминал Артисанов”, помеченный особой иконкой замка или QR. В Pop-up сказано: «Старый заблокированный терминал. Требуется сканирование для доступа.» Также может быть подсказка из metadata.qrHint: «Осмотрите старый электрощит – там нарисован символ шестерёнки.» Кнопки:

[Навигация] – проложить маршрут к месту, где находится терминал.

[Сканировать QR] – активирует режим камеры внутри приложения. Игроку необходимо физически дойти до указанного терминала и найти там QR-код (например, наклейку или граффити с кодом). Наводя камеру, он пытается считать код. Если сканирование успешно (код распознан), приложение вызывает на сервере мутацию mapPoints.activateByQR, передавая идентификатор игрока и считанный код

. На сервере точка находиться по этому QR и помечается как “исследованная” (записывается факт открытия в point_discoveries и присваивается награда за исследование)

. Игрок немедленно получает опыт — размер XP зависит от уровня опасности точки (например, “low” – 50 XP, “medium” – 75 XP, “high” – 125 XP

). В нашем примере старый терминал вряд ли очень опасен, дадим, скажем, 50 XP. Интерфейс отобразит сообщение об успешном сканировании: название точки и +XP, после чего окно сканера автоматически закроется через пару секунд

. Теперь состояние точки обновляется: на карте иконка может сменить цвет (с закрытой на обычную), а во всплывающем окне [Взаимодействовать] станет активной. Нажав её, игрок получит доступ к содержимому терминала – например, прочтёт архивные записи или получит скрытый мини-квест.
Если же сканирование не удалось (не тот QR или сбой), игра сообщит об ошибке без вылета: “Код не распознан” или “Нет соединения”

, позволяя попробовать снова.

3. Логика поведения игрока: первые шаги

Поскольку наш герой – Рационалист, он подходит к выживанию продуманно и прагматично. Вероятный порядок действий после выхода на карту будет следующим:

Выполнение ближайшего квеста “Шанс для новичка”. Этот квест наиболее понятен и обещает прямую выгоду. Ганс недаром посоветовал взяться за него в первую очередь – за выполнение обещана награда (в том числе деньги или репутация). Рациональный игрок рассуждает, что сначала стоит укрепить своё положение и заработать немного средств. Маркер ярко выделен на карте, и цель находится недалеко, в пределах стартовой зоны. Скорее всего, игрок нажмёт “Навигация” на маркере лавки Элиаса и отправится туда. Прибыв на рынок и встретившись с Элиасом (через диалог-сцену), он получит ящик с запчастями. Затем следующим шагом будет отнести этот груз Дитеру в мастерскую. На карте после разговора с Элиасом, вероятно, автоматически появится или станет активной точка “Мастерская Дитера” – там можно сдать посылку. Игрок проследует туда, передаст ящик мастеру (ещё одна короткая сцена). Квест будет выполнен: система отметит его завершённым через completeQuest, начислит обещанные награды (например, +5 единиц славы

, возможно, немного опыта) и, возможно, даст начальное денежное вознаграждение. Результат: герой заработает первые ресурсы, установит контакт с местными (Элиас и Дитер) и укрепит свою репутацию как надёжный новичок

. Кроме того, выполнение этого задания может разблокировать дальнейшие квесты у фракции Артисанов или торговцев.

Продвижение основной миссии (доставка посылки профессору). Получив первоначальные средства и освоившись, игрок обратит внимание на своё главное поручение – найти профессора из Синтеза и передать ему важные документы

. Логично предположить, что после завершения дел на станции и с Гансом, персонаж захочет выполнить задание, с которым собственно прибыл во Фрайбург. Однако информации недостаточно: у игрока есть только догадка, что профессора можно поискать в кампусе Синтеза. Рационалист взвесит свои возможности: сразу отправляться в кампус (который, возможно, находится за пределами стартового района) или сначала разузнать точнее. Вероятно, оптимальным будет сначала собрать сведения:

Можно вернуться к старушке-регистратору и спросить, знает ли она что-то о профессоре (возможно, она упоминала контакты в Синтезе или могла бы уточнить путь).

Либо расспросить других NPC по пути (например, того же Элиаса или Дитера) – иногда диалоги могут содержать дополнительные подсказки.

Получив нужную информацию (конкретный адрес или контакт профессора), игрок отправится в район Синтеза. Когда точное местоположение станет известно, на карте, вероятно, появится чёткий маркер профессора, и игрок сможет взаимодействовать с ним через сцену передачи посылки. Это продвинет основной сюжет. (Если же игрок пойдёт в кампус сразу, без подготовки, геймдизайн может всё равно позволить найти профессора интуитивно, но это будет сложнее и может потребовать опросить тамошних NPC.)

Альтернативные исследования и побочные задания. Игрок не обязан немедленно бежать по основным целям. Старушка дала ему несколько наводок, и любопытный или осторожный рационалист мог бы решить осмотреться шире:

Например, отправиться в Промзону Артисанов вместо рынка. Там, если он поищет, можно обнаружить, скажем, доску объявлений ремесленников или встретить какого-нибудь бригадира. Такая доска (тип точки bulletin_board) могла бы дать другое стартовое задание – не связанное с Гансом. Допустим: квест “Полевая медицина” от фракции Синтез (помочь собрать материалы) или мелкое поручение от Артисанов. В данных сидов, например, есть доска объявлений FJR с набором заданий

. Аналогично может существовать доска Артисанов. Получив альтернативный квест, игрок начнёт продвигаться по нему, знакомясь с соответствующей фракцией. Это путь для тех, кто игнорирует совет Ганса.

Другой вариант: направиться к кафедралю и поговорить с Отцом Иоанном (если тот присутствует на карте). Возможно, он попросит помощи с каким-то делом, открывая цепочку квестов “староверов”.

Можно попытаться сунуться и в анархистский квартал из любопытства. Рациональный игрок, правда, помнит предупреждение и, вероятно, не полезет на рожон без подготовки. Но если пойдёт, то рискует попасть в неприятности или встретить не самых дружелюбных NPC. Геймдизайн, скорее всего, ограничит прогресс в опасные зоны на первом этапе (например, через сильных врагов или закрытые переходы), но сам факт, что игрок волен идти куда хочет, важен для ощущения открытого мира.

В итоге, игра не линейно заставляет делать только квест Ганса – у игрока есть выбор. Однако разумный путь (особенно для характера Рационалиста) – сначала укрепиться на простом задании, затем взяться за основную задачу, имея немного ресурсов и знаний. Побочные активности остаются на усмотрение игрока и служат для дополнительного погружения и прокачки.

4. Динамические события (“зоны поиска”)

Пока игрок перемещается по городу, система может генерировать кратковременные динамические точки – так называемые “зоны поиска”. Эти события не заранее отмечены на карте, а появляются при выполнении определённых условий (например, игрок оказался в конкретном районе, либо прошло немного времени с начала игры).

 

Пример события: По пути от станции к лавке Элиаса (то есть вскоре после выхода из зелёной зоны станции) игрок проходит мимо узкого переулка между зданиями. На карте или в интерфейсе внезапно появляется индикатор (например, мигающая область или значок лупы) с подписью: «Странный сигнал / Свежие следы». Это означает, что поблизости обнаружено нечто интересное. У персонажа срабатывают внутренние чувства:

[ИНТУИЦИЯ]: (шёпотом) «…здесь что-то… не так…» – смутное ощущение, призывающее обратить внимание.

[ЛОГИКА]: (спокойно) «Отклонение от маршрута — рискованный шаг. Вероятность опасности ~47%. Но потенциальная награда или ценная информация могут оправдать риск.»

Игрок должен решить – свернуть в переулок и исследовать источник сигнала или игнорировать и идти дальше по главному заданию. Если он исследует, то геймплей переходит в режим поиска: на земле обнаруживаются, скажем, следы волочащейся крови и помехи по КПК сигналу. В конце переулка игрок находит тело сталкера с рюкзаком. Осмотрев находку (через интерактивную сцену или простой лут интерфейс), он получает записку, которая запускает небольшой побочный квест (например, узнать, что случилось с этим сталкером, или отнести его жетон в штаб FJR). Однако сразу после этого на игрока могут напасть два мелких мутанта, прятавшихся поблизости – первое боевое крещение вне безопасной зоны. Если у игрока есть оружие, произойдёт небольшой бой. Победив, он получит трофеи и опыт; если же ситуация окажется слишком опасной, всегда можно попытаться сбежать обратно на территорию патрулируемую FJR (в зеленую зону). В любом случае, событие разовое: как только игрок покинет зону или по прошествии нескольких минут бездействия, “зона поиска” исчезнет. Эти динамические точки предназначены наградить любознательных, добавив элемент непредсказуемости и живости миру. Для рационалиста же подобная дилемма – проверить аномалию или избежать риска – сама по себе интересна: его решения будут влиять на то, насколько осторожно или азартно он играет.

 

(Примечание: В реализации такие события могут быть привязаны к таймеру или триггеру по локации. Они не отмечены на карте постоянно, а возникают contextually. Если игрок пропустил событие, ничего страшного – впереди будут другие.)

5. UX/UI и интеграция с системами игры

Описанные выше механики тесно связывают интерфейс карты с бэкенд-логикой (Convex) и данными прогресса. Ниже перечислены ключевые элементы реализации и последовательности событий:

Отображение видимых точек: при первом открытии карты клиент запрашивает у сервера список доступных точек через метод mapPoints.listVisible, указывая текущие координаты/область и фазу игры

. Сервер возвращает все активные точки, удовлетворяющие условиям (правильная фаза, разблокированные по флагам, попадающие в область обзора)

. Таким образом, на старте игрок видит только релевантные точки (станция, близлежащие квесты, подсказанные локации) – остальные скрыты до поры

. Данные точек включают их тип, название, описание и метаданные: например, привязки к квестам и сценам, требования для разблокировки, наличие QR-кода и уровень опасности

. Клиент отрисовывает эти точки на карте соответствующими иконками (квесты, NPC, области и т.д.).

Выбор точки и меню взаимодействия: когда игрок нажимает на значок точки, фронтенд проверяет, есть ли у неё несколько вариантов действий (interactionMenu). Если да – отображается меню с опциями (как в случае с торговцем Элиасом, где были варианты “К товарам”, “Поговорить”, “Есть задание?”)

. Неактивные варианты (по условиям) скрываются или помечаются серым, чтобы не вводить в заблуждение


. Если же у точки единственное действие (например, начать диалог сцены), меню не показывается – игра сразу переходит к соответствующему событию

. В нашем случае с лавкой Элиаса возможен комбинированный подход: при первом визите запускается сцена знакомства автоматически, а затем при повторных – уже появляется меню торговли/разговоров.

Запуск сцены (Visual Novel) и обновление квестов: переход к диалоговой сцене происходит через навигацию на экран /visual-novel с указанием sceneId. Во время или по завершении сцены движок применяет эффекты: устанавливает флаги, продвигает шаги квеста, начисляет опыт или репутацию в зависимости от решений игрока

. Например, когда игрок завершает сцену встречи с Элиасом, может выставиться флаг met_elias и обновиться шаг квеста “Шанс для новичка” на “получен груз”. Фронтенд вызывает quests.updateQuestProgress или специальную мутацию vn.commitScene, передавая, какие флаги/шаги достигнуты

. Бэкенд (Convex) обновляет соответствующие записи: добавляет сцену в visitedScenes, помечает квест “доставить запчасти” как в прогрессе (шаг выполнен) и возвращает подсказку следующей цели (например, «Теперь отнесите ящик Дитеру в мастерскую»)

. Если к точке привязана система mappoint_bindings для квеста, то посещение точки или окончание сцены может автоматически продвинуть квест до следующего шага

. После диалога с Элиасом игра, вероятно, подсветит на карте мастерскую Дитера как новую цель. Когда же игрок выполнит финальный шаг (встретится с Дитером и передаст посылку), вызовется quests.completeQuest – квест закроется, и игрок получит награды (слава, XP, предметы и т.д.)

. Все эти изменения мгновенно отражаются в UI: в списке активных квестов появляется прогресс/галочки, маркеры квестов обновляются (иконка Элиаса может пропасть или стать неактивной, иконка Дитера – погаснуть после завершения).

Сканирование QR и исследование объектов: интерфейс сканирования QR-кода (QRPointActivation панель) позволяет игроку взаимодействовать с объектами в реальном мире через игру. Когда игрок нажимает кнопку “Сканировать” и успешно считывает код, вызывается серверная функция mapPoints.activateByQR

. На сервере происходит:

По полученному qrCode находится соответствующая точка в таблице map_points (у таких точек QR заранее занесён в metadata при сидировании).

Для этого игрока создаётся или обновляется запись в point_discoveries, помечая точку как открытую (discovered) и исследованную (researched) с текущим timestamp

.

Игроку начисляется опыт, величина которого определяется полем danger_level точки (например, low/medium/high соответствует 50/75/125 XP)


. Одновременно проверяется, не достигнут ли новый уровень (если да – увеличивается уровень и выдаётся очко навыка).

Сервер возвращает результат успеха. Клиент показывет уведомление об успешном исследовании (+XP, название точки) и закрывает сканер

. Далее, состояние точки на карте обновляется: она становится активной. Если у точки была сцена или контент, теперь их можно запускать. (Заметим, что для закрытых точек обычно в metadata есть флаг qrRequired, чтобы запрещать взаимодействие до сканирования.)

При неудаче (неизвестный QR или ошибка) сервер возвращает ошибку, и UI отображает понятное сообщение (например, “Этот код не связан с объектом” или “Не удалось подключиться”), позволяя попробовать снова

.

Отображение безопасных зон и выход в опасные территории: на клиентской карте предусмотрен слой безопасных зон (Safe Zones), который можно включать для ориентира

. В начале игры этот слой, возможно, автоматически активирован, поэтому станция обведена зелёным. Safe Zone данные загружаются (например, через zones.listSafeZones) и представляют собой полигоны с именами фракций

. Если игрок выключит слой, контур пропадёт – это чисто визуальный элемент для удобства. Опасные зоны (Danger Zones) могут быть реализованы аналогично, но изначально их нет на карте, пока игрок сам не узнает о них. Например, после определённых миссий на карте могут отображаться красные области аномалий. В момент первого выхода за пределы станции игрока ничто графически не уведомляет, что он в опасности, кроме исчезновения зелёного контура вокруг. Однако геймдизайн может добавить предупреждение: как только герой покидает безопасную территорию, интерфейс (КПК) выводит сообщение типа “Внимание: вы покинули безопасную зону FJR”. С этого момента возможны случайные стычки и события. NPC-союзники здесь не защищают, поэтому стоит быть начеку. (Если игрок поспешно вернётся обратно в зелёную зону, динамические опасности прекратят его преследовать – это механика убеспечения для новичков.)

Повторное взаимодействие с NPC: как отмечалось, у игрока есть возможность вернуться к некоторым NPC для дополнительных разговоров. В реализации это может быть та же самая сцена диалога, но с веткой, учитывающей повторное обращение. Например, старушка-регистратор при повторном клике может вывести реплику: «Ещё раз привет, милок. Загляни в промзону к Артисанам, там, говорят, работёнка есть, и будь осторожен на Августинерплац…» — фактически краткое резюме её прошлых советов. Новых флагов такой разговор не даёт, это просто опциональная подсказка. Ганс, если доступен на карте в первые минуты, может при повторном взаимодействии ограничиться фразой напутствия или шуткой, но без новых заданий. После этого его иконка исчезнет (в коде можно не создавать постоянной точки Ганса, а временно показывать его через UI-маркер).
В дальнейшем, по мере прогресса, на карте появятся новые NPC и их диалоги. Система sceneBindings в данных точки позволяет привязывать разные сцены к одному NPC в разных условиях


. Таким образом, один и тот же персонаж может реагировать по-разному в зависимости от выполненных квестов или времени. Разработчикам важно не забыть отключить или изменить первоначальные диалоги после их актуальности, чтобы игрок не застрял в старом сценарии. В данном случае, после регистрации и получения КПК, сцена info_bureau_meeting у старушки больше не запускается, зато может появиться другая при наступлении новой фазы игры.

Структура компонентов интерфейса: реализация карты разделена на несколько UI-компонентов. Основной холст – компонент MapView, отвечающий за отображение тайлов карты (например, Mapbox), значков точек и слоёв. При выборе точки открывается виджет InteractionMenu/MapPointPopup, отображающий информацию о точке и кнопки (опции)

. Существует также боковая панель PointsListPanel (список всех точек в зоне) и MapLegendPanel (условные обозначения и фильтры)

. У игрока есть HUD с кнопками: например, “Центрировать на мне” для геолокации

, переключатель “Safe Zones” для отображения зон

. Когда запускается визуальная новелла, происходит навигация на страницу VisualNovelPage – там UI сменяется на полноэкранный режим диалога, а карта прячется

. После окончания сцены, по сигналу commitScene, игра может либо автоматически возвращать игрока на карту, либо переходить к другой сцене/экрану в зависимости от сюжета.

Взаимодействие клиент-сервер: практически каждая значимая акция игрока на карте вызывает мутацию или запрос к бэкенду (Convex). Например, при сканировании QR – mapPoints.activateByQR, при открытии карты – mapPoints.listVisible, при завершении сцены – vn.commitScene или quests.completeQuest. Эти вызовы проходят через сгенерированный API клиента

. В исходном коде проекта есть соответствующие функции-мутации: markResearched для пометки точки исследованной вручную (если, например, разработчик хочет засчитать точку без QR)

, activateByQR для обработки сканирования

, startQuest/updateQuestProgress/completeQuest для управления квестами

, listSafeZones для получения зон и т.п. В архитектуре Convex все эти функции уже описаны и могут вызываться с клиента асинхронно. Такое разделение обеспечивает целостность логики: вся проверка условий (флаги, доступность точки по фазе, предотвращение повторного получения награды и пр.) выполняется на сервере, а клиент отвечает только за отображение и пользовательский ввод. Это снижает вероятность читерства и позволяет легко менять баланс (например, XP за точки) на стороне сервера без обновления клиента.

Подводя итог, первый выход игрока на карту объединяет нарративные элементы (свобода выбора пути, внутренняя логика героя), дизайн уровня (расположение точек, подсказки, ограничение видимости территории) и технические системы (UI карта + серверные данные). Такой интегрированный подход обеспечивает глубоко проработанный опыт: игрок чувствует себя участником живого мира, где интерфейс КПК и игровые механики логично связаны с сюжетом. Каждое действие – клик по точке, сканирование кода, разговор с NPC – не просто UI-операция, а часть повествования и прогресса персонажа.

 

Примечание по оформлению: Данный фрагмент лучше представить как часть геймдизайн-документа, описывающего игровой процесс и опыт игрока. В нём уместно сочетать повествовательное описание (что видит и делает игрок) с указанием ключевых механик. Короткие примеры диалогов (например, реплики [ИНТУИЦИЯ] и [ЛОГИКА]) полезны для передачи атмосферы, но не стоит перегружать документ полным сценарием диалогов – детальные скрипты лучше вынести в отдельный сценарный раздел или файлы (как visual novel сцены). В документации для разработчиков на GitHub можно включить технические подробности: структуры данных, вызовы Convex-API, компоненты UI (многие из которых упомянуты выше). Таким образом, для дизайна мы фокусируемся на механиках и интерактиве, с минимальными вкраплениями текстов реплик чисто для примера, а подробные тексты разговоров NPC хранятся отдельно. Такой раздел можно поместить в GDD под главой “Первый выход на карту (пост-пролог)”, а в репозитории сделать ссылку или комментарии в коде, объясняющие, как эти механики реализованы, с отсылкой к GDD для контекста.