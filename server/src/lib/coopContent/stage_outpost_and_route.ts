import type { CoopQuestNode } from '../../shared/types/coop'

export const COOP_STAGE_OUTPOST_AND_ROUTE_NODES: Record<string, CoopQuestNode> = {
    // NOTE: outpost_tent moved to stage_prologue.ts as prologue_start
    // NOTE: briefing_intruder, briefing_orders, briefing_questions removed as unreachable

    move_out: {
        id: 'move_out',
        title: 'Проводы в Ад: Выход из палатки',
        background: '/images/Мультиплеер/сцена3.1Лагерь.png',
        description: `
Комикс‑кадр, средний план. Полог палатки откидывается. Первым выходит Прайс, за ним — отряд сталкеров (вы).

Их встречает холодный, серый рассвет. Камера показывает вас со спины. Перед вами — панорама военного лагеря: солдаты FJR в экзоброне, укреплённые пулемётные гнёзда, выжженная земля, усеянная останками химер. В воздухе висит туман, смешанный с дымом.

АГАТА (тихо, с нехарактерной для неё серьёзностью): «М-да... Вечеринка, похоже, была жаркой».
`,
        interactionType: 'sync',
        choices: [{ id: 'frame2', text: 'Далее', nextNodeId: 'move_out_glances' }],
    },

    move_out_glances: {
        id: 'move_out_glances',
        title: 'Проводы в Ад: Молчаливые взгляды',
        background: '/images/Мультиплеер/сцена3.1Лагерь.png',
        description: `
Комикс‑кадр, серия из нескольких мелких панелей. Крупные планы лиц солдат FJR, которые провожают вас взглядами. На одном лице — усталость. На другом — зависть. На третьем — жалость. Один молодой солдат незаметно крестит вас вслед.

Молчаливый монтаж говорит ясно: сталкеры — те, кто идёт туда, куда боятся идти даже закалённые вояки. Вы — смертники.

ПРАЙС (голос из динамиков шлема, глухой и механический): «Не обращайте внимания. Они нам завидуют. Им тут скучно. Выдвигаемся».
`,
        interactionType: 'sync',
        choices: [{ id: 'to_route', text: 'Выдвигаемся', nextNodeId: 'pre_rift_route' }],
    },

    pre_rift_route: {
        id: 'pre_rift_route',
        title: 'Маршрут',
        background: '/images/Мультиплеер/сцена3.1Лагерь.png',
        description: `
Лагерь быстро глохнет за спиной. Остаются ветер и нарастающий гул Разлома.

Прайс коротко: «До площадки перед Разломом — несколько подходов. Выбираем быстро и без героизма».
`,
        interactionType: 'vote',
        choices: [
            {
                id: 'route_main',
                text: 'Основная тропа (быстрее, но на виду)',
                nextNodeId: 'pre_rift_route_main',
            },
            {
                id: 'route_ridge',
                text: 'Гребень (обзор, но открытый ветер и осыпи)',
                nextNodeId: 'pre_rift_route_ridge',
            },
            {
                id: 'route_lowland',
                text: 'Низина (укрытие, но больше “карманов” и аномалий)',
                nextNodeId: 'pre_rift_route_lowland',
            },
            {
                id: 'route_wrecks',
                text: 'По следам техники (можно найти данные, но металл может быть “живым”)',
                nextNodeId: 'pre_rift_route_wrecks',
            },
            {
                id: 'route_sidequest_signal',
                text: 'Сделать крюк: проверить аварийный сигнал (побочный квест)',
                nextNodeId: 'sq_signal_cache_start',
                action: 'start_side_quest',
                questId: 'signal_cache',
            },
        ],
    },

    pre_rift_route_main: {
        id: 'pre_rift_route_main',
        title: 'Основная тропа',
        background: '/images/Мультиплеер/сцена3.1Лагерь.png',
        description: `
Тропа вытоптана сапогами и кровью. Здесь уже ходили “железные” — и возвращались не все.

Но путь прямой. А значит — честный.
`,
        interactionType: 'sync',
        choices: [{ id: 'route_main_next', text: 'Далее', nextNodeId: 'approach_climb' }],
    },

    pre_rift_route_ridge: {
        id: 'pre_rift_route_ridge',
        title: 'Гребень',
        background: '/images/Мультиплеер/сцена3.1Лагерь.png',
        description: `
Вы забираетесь выше. Ветер режет по забралу, камень под ногами сухой и злой, но обзор — как на ладони.

Если кто-то ждёт впереди — вы увидите это раньше.
`,
        interactionType: 'sync',
        choices: [{ id: 'route_ridge_next', text: 'Далее', nextNodeId: 'approach_climb' }],
    },

    pre_rift_route_lowland: {
        id: 'pre_rift_route_lowland',
        title: 'Низина',
        background: '/images/Мультиплеер/сцена3.1Лагерь.png',
        description: `
Вы уходите в низину, где скалы прикрывают от глаз и ветра. Воздух здесь тяжелее — и пахнет болотом.

Это место любит накапливать сюрпризы.
`,
        interactionType: 'sync',
        choices: [{ id: 'route_lowland_next', text: 'Далее', nextNodeId: 'approach_climb' }],
    },

    pre_rift_route_wrecks: {
        id: 'pre_rift_route_wrecks',
        title: 'Следы техники',
        background: '/images/Мультиплеер/сцена3.1Лагерь.png',
        description: `
Обрывки кабеля. Вмятины в камне. Следы гусениц, которые уже не ведут никуда.

Тут можно найти ответы… если металл не решит “съесть” тебя первым.
`,
        interactionType: 'sync',
        choices: [{ id: 'route_wrecks_next', text: 'Далее', nextNodeId: 'approach_climb' }],
    },

    approach_climb: {
        id: 'approach_climb',
        title: 'Чтение Шрамов',
        background: '/images/Мультиплеер/Сцена2ПередРазломом.png',
        description: `
Группа покидает лагерь и начинает подъём по склону. Шум аванпоста стихает. Теперь слышен только ветер и нарастающий гул Разлома.

Начинается фаза исследования. У каждого игрока на экране появляются свои уникальные точки интереса и задачи. Информацию придётся собирать по кускам и передавать друг другу вслух.

ПРАЙС (по рации): «Всем смотреть в оба. Ева, Иоганн, мне нужны данные по окружающей среде. Дитрих, ищи следы и угрозы. Агата... постарайся ничего не взрывать. Пока что».
`,
        privateText: {
            valkyrie: [
                'Твой Экран, Ева «Валькирия» (Медик):',
                'Твой медицинский сканер переключен в режим био-анализа. Твой HUD подсвечивает биологически активные объекты.',
                '',
                '[ТОЧКА ИНТЕРЕСА 1: Светящийся Мох]',
                'Действие: Навести сканер, провести анализ.',
                '',
                '[ТОЧКА ИНТЕРЕСА 2: Кристаллизованная Кровь]',
                'Действие: Взять образец (с помощью манипулятора).',
                '',
                'Обменивайся находками с группой вслух.',
            ].join('\n'),
            vorschlag: [
                'Экран Иоганна «Vorschlag» (Техник):',
                'Твой сканер ищет аномалии в материалах и энергетические поля.',
                '',
                '[ТОЧКА ИНТЕРЕСА 1: Остатки Бронемашины]',
                'Действие: Просканировать поврежденную броню.',
                '',
                '[ТОЧКА ИНТЕРЕСА 2: Искаженное Дерево]',
                'Действие: Просканировать гравитационную аномалию.',
                '',
                'Обменивайся находками с группой вслух.',
            ].join('\n'),
            ghost: [
                'Экран Дитриха «Призрак» (Снайпер):',
                'Твой интерфейс подсвечивает следы и потенциальные укрытия/огневые точки.',
                '',
                '[ТОЧКА ИНТЕРЕСА 1: Следы Химер]',
                'Действие: Проанализировать следы.',
                '',
                '[ТОЧКА ИНТЕРЕСА 2: Идеальная Позиция]',
                'Действие: Оценить скальный уступ.',
                '',
                'Обменивайся находками с группой вслух.',
            ].join('\n'),
            shustrya: [
                'Экран Агаты «Шустрая» (Подрывник):',
                'Твой интерфейс ищет разрушаемые объекты и взрывоопасные вещества.',
                '',
                '[ТОЧКА ИНТЕРЕСА 1: Газовый Карман]',
                'Действие: Просканировать расщелину в земле.',
                '',
                '[ТОЧКА ИНТЕРЕСА 2: Нестабильная Скала]',
                'Действие: Оценить нависающий над тропой скальный карниз.',
                '',
                'Обменивайся находками с группой вслух.',
            ].join('\n'),
        },
        interactionType: 'individual',
        choices: [
            {
                id: 'valk_moss',
                text: '[VALKYRIE] Светящийся мох — био-анализ',
                requiredRole: 'valkyrie',
                effectText:
                    'HUD: АНАЛИЗ: ФЛОРА, ТИП НЕИЗВЕСТЕН. СВЕЧЕНИЕ — РЕЗУЛЬТАТ СИМБИОЗА С МИКРООРГАНИЗМАМИ, ПОГЛОЩАЮЩИМИ ПСИ-ЭНЕРГИЮ. ОПАСНОСТЬ: ПРИ ПРЯМОМ КОНТАКТЕ ВЫЗЫВАЕТ ЛЁГКИЕ ГАЛЛЮЦИНАЦИИ.\n\nДоклад: «На камнях мох, светится. Не трогать. Вызывает глюки. Агата — тебя касается в первую очередь».',
                nextNodeId: 'scars_checkpoint',
            },
            {
                id: 'valk_blood',
                text: '[VALKYRIE] Кристаллизованная кровь — взять образец',
                requiredRole: 'valkyrie',
                effectText:
                    'HUD: АНАЛИЗ: ОРГАНИЧЕСКОЕ СОЕДИНЕНИЕ. ГЕМОГЛОБИН НЕИЗВЕСТНОГО ТИПА. КРАЙНЕ ЭНЕРГОЁМКИЙ. ПОТЕНЦИАЛЬНЫЙ СТИМУЛЯТОР.\n\nИнъекция: «Эта кровь... она как концентрат адреналина. Если её очистить, можно сделать боевой стимулятор невероятной силы. Или яд. Грань тонкая».\n\nHUD: ДОБАВЛЕНО: РЕЦЕПТ (ПРОТОТИП) — “СТИМУЛ РАЗЛОМА”.\n\nДоклад: «Кристаллизованная кровь. Энергоёмкая. Может стать стимом… или отравой».',
                nextNodeId: 'scars_checkpoint',
            },
            {
                id: 'vor_armor',
                text: '[VORSCHLAG] Остатки бронемашины — скан брони',
                requiredRole: 'vorschlag',
                effectText:
                    'HUD: АНАЛИЗ КОРРОЗИИ: НАНО-ОРГАНИЧЕСКИЕ КИСЛОТЫ. СТРУКТУРА МЕТАЛЛА ДЕСТАБИЛИЗИРОВАНА НА МОЛЕКУЛЯРНОМ УРОВНЕ. СТАНДАРТНАЯ ЗАЩИТА НЕЭФФЕКТИВНА.\n\nДоклад: «Парни, тут броня БТР... она не прожжена — она разложена. Как будто состарилась на тысячу лет за секунду. Наши броники против этого — картон».',
                nextNodeId: 'scars_checkpoint',
            },
            {
                id: 'vor_tree',
                text: '[VORSCHLAG] Искажённое дерево — гравитационная аномалия',
                requiredRole: 'vorschlag',
                effectText:
                    'HUD: ВНИМАНИЕ! ОБНАРУЖЕНА ЛОКАЛЬНАЯ ГРАВИТАЦИОННАЯ АНОМАЛИЯ. СИЛА: 1.5G. НЕСТАБИЛЬНА.\n\nИоганн (восхищённо): «Вот это да... Оно... оно искажает пространство вокруг себя! Как чёрная дыра в миниатюре! Нужно понять, как оно это делает!»\n\nДоклад: «Локальная гравитация, 1.5G, нестабильно. Не подходить близко».',
                nextNodeId: 'scars_checkpoint',
            },
            {
                id: 'ghost_tracks',
                text: '[GHOST] Следы химер — анализ',
                requiredRole: 'ghost',
                effectText:
                    'HUD: АНАЛИЗ СЛЕДОВ: 3 ОСОБИ. ДВИГАЛИСЬ БЫСТРО, С ЗАПАДА НА ВОСТОК. СЛЕДЫ СВЕЖИЕ, НЕ БОЛЕЕ ЧАСА. УШЛИ В СТОРОНУ РАЗЛОМА.\n\nДоклад: «Командир. Трое. Свежие. Ушли к нашей цели. Возможно, ждут нас там».',
                nextNodeId: 'scars_checkpoint',
            },
            {
                id: 'ghost_nest',
                text: '[GHOST] Идеальная позиция — оценить уступ',
                requiredRole: 'ghost',
                effectText:
                    'HUD: АНАЛИЗ ПОЗИЦИИ: ВЫСОТА: +25М. ОБЗОР: 180 ГРАДУСОВ. СЕКТОР ОБСТРЕЛА: ВСЯ ПЛОЩАДКА ПЕРЕД РАЗЛОМОМ. ИДЕАЛЬНАЯ СНАЙПЕРСКАЯ ПОЗИЦИЯ.\n\nИнъекция: «Отсюда я мог бы прикрыть их всех. Один выстрел — одна цель. Как тогда... Нет. Не думать об этом».\n\nДоклад: «Нашёл уступ. Обзор на всю площадку. Могу прикрывать сверху».',
                nextNodeId: 'scars_checkpoint',
            },
            {
                id: 'shus_gas',
                text: '[SHUSTRAYA] Газовый карман — сканирование',
                requiredRole: 'shustrya',
                effectText:
                    'HUD: АНАЛИЗ: ОБНАРУЖЕНО СКОПЛЕНИЕ БОЛОТНОГО МЕТАНА. ВЫСОКАЯ КОНЦЕНТРАЦИЯ. ЛЕГКОВОСПЛАМЕНЯЕМ.\n\nДоклад: «Эй, народ, а тут природная бомба! Если что-то полезет из этой щели — хватит одной искры, чтобы устроить фейерверк!»',
                nextNodeId: 'scars_checkpoint',
            },
            {
                id: 'shus_rock',
                text: '[SHUSTRAYA] Нестабильная скала — оценка карниза',
                requiredRole: 'shustrya',
                effectText:
                    'HUD: АНАЛИЗ СТРУКТУРЫ: НЕСТАБИЛЬНА. МНОЖЕСТВЕННЫЕ ТРЕЩИНЫ. ДЛЯ ОБРУШЕНИЯ ДОСТАТОЧНО ТОЧЕЧНОГО ВЗРЫВА МАЛОЙ МОЩНОСТИ.\n\nАгата (потирая руки): «Идеально. Если за нами будет погоня — можно будет обрушить им на головы пару тонн камней. Запишем...»\n\nДоклад: «Карниз трещит. Один небольшой заряд — и всё вниз».',
                nextNodeId: 'scars_checkpoint',
            },
            {
                id: 'scars1_skip',
                text: 'Не отвлекаться (держать строй)',
                effectText: 'Ты просто идёшь. Иногда дисциплина — лучший сенсор.',
                nextNodeId: 'scars_checkpoint',
            },
        ],
    },

    scars_checkpoint: {
        id: 'scars_checkpoint',
        title: 'Сверка данных',
        background: '/images/Мультиплеер/Сцена2ПередРазломом.png',
        description: `
Короткие доклады режут эфир. Вы не обязаны понимать всё — достаточно запомнить главное и передать дальше.

Прайс: «Ещё минута на разведку — или идём на площадку. Решаем».
`,
        interactionType: 'vote',
        choices: [
            { id: 'scars_more', text: 'Ещё один круг сканирования', nextNodeId: 'approach_climb_2' },
            { id: 'scars_go', text: 'Не задерживаться — к площадке', nextNodeId: 'rift_face' },
        ],
    },

    approach_climb_2: {
        id: 'approach_climb_2',
        title: 'Чтение Шрамов: Второй проход',
        background: '/images/Мультиплеер/Сцена2ПередРазломом.png',
        description: `
Ещё минута на исследование и сверку. Если у тебя осталась “вторая метка” — самое время снять данные и проговорить их группе.
`,
        privateText: {
            valkyrie:
                'Ещё минута на анализ. Сними второй сигнал или перепроверь выводы — и передай их вслух.',
            vorschlag:
                'Ещё минута на скан. Если видишь второй сигнал — сними его и доложи группе.',
            ghost:
                'Ещё минута на угрозы и позиции. Делай метки, считай сектор, докладывай.',
            shustrya:
                'Ещё минута на ловушки и точки обрушения. Отмечай и докладывай.',
        },
        interactionType: 'individual',
        choices: [
            {
                id: 'valk_blood_2',
                text: '[VALKYRIE] Кристаллизованная кровь — взять образец',
                requiredRole: 'valkyrie',
                effectText:
                    'HUD: АНАЛИЗ: ОРГАНИЧЕСКОЕ СОЕДИНЕНИЕ. ГЕМОГЛОБИН НЕИЗВЕСТНОГО ТИПА. КРАЙНЕ ЭНЕРГОЁМКИЙ. ПОТЕНЦИАЛЬНЫЙ СТИМУЛЯТОР.\n\nИнъекция: «Эта кровь... она как концентрат адреналина. Если её очистить, можно сделать боевой стимулятор невероятной силы. Или яд. Грань тонкая».\n\nHUD: ДОБАВЛЕНО: РЕЦЕПТ (ПРОТОТИП) — "СТИМУЛ РАЗЛОМА".\n\nДоклад: «Кристаллизованная кровь. Энергоёмкая. Может стать стимом… или отравой».',
                nextNodeId: 'rift_face',
            },
            {
                id: 'valk_moss_2',
                text: '[VALKYRIE] Светящийся мох — био-анализ',
                requiredRole: 'valkyrie',
                effectText:
                    'HUD: АНАЛИЗ: ФЛОРА, ТИП НЕИЗВЕСТЕН. СВЕЧЕНИЕ — РЕЗУЛЬТАТ СИМБИОЗА С МИКРООРГАНИЗМАМИ, ПОГЛОЩАЮЩИМИ ПСИ-ЭНЕРГИЮ. ОПАСНОСТЬ: ПРИ ПРЯМОМ КОНТАКТЕ ВЫЗЫВАЕТ ЛЁГКИЕ ГАЛЛЮЦИНАЦИИ.\n\nДоклад: «На камнях мох, светится. Не трогать. Вызывает глюки. Агата — тебя касается в первую очередь».',
                nextNodeId: 'rift_face',
            },
            {
                id: 'vor_tree_2',
                text: '[VORSCHLAG] Искажённое дерево — гравитационная аномалия',
                requiredRole: 'vorschlag',
                effectText:
                    'HUD: ВНИМАНИЕ! ОБНАРУЖЕНА ЛОКАЛЬНАЯ ГРАВИТАЦИОННАЯ АНОМАЛИЯ. СИЛА: 1.5G. НЕСТАБИЛЬНА.\n\nЙоханн (восхищённо): «Вот это да... Оно... оно искажает пространство вокруг себя! Как чёрная дыра в миниатюре! Нужно понять, как оно это делает!»\n\nДоклад: «Локальная гравитация, 1.5G, нестабильно. Не подходить близко».',
                nextNodeId: 'rift_face',
            },
            {
                id: 'vor_armor_2',
                text: '[VORSCHLAG] Остатки бронемашины — скан брони',
                requiredRole: 'vorschlag',
                effectText:
                    'HUD: АНАЛИЗ КОРРОЗИИ: НАНО-ОРГАНИЧЕСКИЕ КИСЛОТЫ. СТРУКТУРА МЕТАЛЛА ДЕСТАБИЛИЗИРОВАНА НА МОЛЕКУЛЯРНОМ УРОВНЕ. СТАНДАРТНАЯ ЗАЩИТА НЕЭФФЕКТИВНА.\n\nДоклад: «Парни, тут броня БТР... она не прожжена — она разложена. Как будто состарилась на тысячу лет за секунду. Наши броники против этого — картон».',
                nextNodeId: 'rift_face',
            },
            {
                id: 'ghost_nest_2',
                text: '[GHOST] Идеальная позиция — оценить уступ',
                requiredRole: 'ghost',
                effectText:
                    'HUD: АНАЛИЗ ПОЗИЦИИ: ВЫСОТА +25М. ОБЗОР 180°. СЕКТОР ОБСТРЕЛА: ВСЯ ПЛОЩАДКА ПЕРЕД РАЗЛОМОМ. ИДЕАЛЬНАЯ СНАЙПЕРСКАЯ ПОЗИЦИЯ.\n\nИнъекция: «Отсюда я мог бы прикрыть их всех. Один выстрел — одна цель. Как тогда... Нет. Не думать об этом».\n\nДоклад: «Нашёл уступ. Обзор на всю площадку. Могу прикрывать сверху».',
                nextNodeId: 'rift_face',
            },
            {
                id: 'ghost_tracks_2',
                text: '[GHOST] Следы химер — анализ',
                requiredRole: 'ghost',
                effectText:
                    'HUD: АНАЛИЗ СЛЕДОВ: 3 ОСОБИ. ДВИГАЛИСЬ БЫСТРО, С ЗАПАДА НА ВОСТОК. СЛЕДЫ СВЕЖИЕ, НЕ БОЛЕЕ ЧАСА. УШЛИ В СТОРОНУ РАЗЛОМА.\n\nДоклад: «Командир. Трое. Свежие. Ушли к нашей цели. Возможно, ждут нас там».',
                nextNodeId: 'rift_face',
            },
            {
                id: 'shus_rock_2',
                text: '[SHUSTRAYA] Нестабильная скала — оценка карниза',
                requiredRole: 'shustrya',
                effectText:
                    'HUD: АНАЛИЗ СТРУКТУРЫ: НЕСТАБИЛЬНА. МНОЖЕСТВЕННЫЕ ТРЕЩИНЫ. ДЛЯ ОБРУШЕНИЯ ДОСТАТОЧНО ТОЧЕЧНОГО ВЗРЫВА МАЛОЙ МОЩНОСТИ.\n\nАгата (потирая руки): «Идеально. Если за нами будет погоня — можно будет обрушить им на головы пару тонн камней. Запишем...»\n\nДоклад: «Карниз трещит. Один небольшой заряд — и всё вниз».',
                nextNodeId: 'rift_face',
            },
            {
                id: 'shus_gas_2',
                text: '[SHUSTRAYA] Газовый карман — сканирование',
                requiredRole: 'shustrya',
                effectText:
                    'HUD: АНАЛИЗ: ОБНАРУЖЕНО СКОПЛЕНИЕ БОЛОТНОГО МЕТАНА. ВЫСОКАЯ КОНЦЕНТРАЦИЯ. ЛЕГКОВОСПЛАМЕНЯЕМ.\n\nДоклад: «Эй, народ, а тут природная бомба! Если что-то полезет из этой щели — хватит одной искры, чтобы устроить фейерверк!»',
                nextNodeId: 'rift_face',
            },
            {
                id: 'scars2_skip',
                text: 'Не рисковать — идти дальше',
                effectText: 'Ты давишь любопытство и держишь ритм шага.',
                nextNodeId: 'rift_face',
            },
        ],
    },

};

